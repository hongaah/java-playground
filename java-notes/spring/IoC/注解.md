# Spring IOC 相关注解汇总

## 核心注解

### 1. 组件注册注解

1. **@Component**
   - **作用**：标识一个类为 Spring 组件，会被自动扫描并注册为 Bean
   - **原理**：被 `@ComponentScan` 扫描时，Spring 会创建该类的实例并纳入容器管理
   - **使用**：
     ```java
     @Component
     public class UserService {
         // ...
     }
     ```

2. **@Repository**
   - **作用**：标识数据访问层 (DAO) 组件，是 `@Component` 的特化
   - **原理**：与 `@Component` 相同，但具有语义化，Spring 会为它提供额外的数据访问异常转换
   - **使用**：
     ```java
     @Repository
     public class UserRepository {
         // ...
     }
     ```

3. **@Service**
   - **作用**：标识服务层组件，是 `@Component` 的特化
   - **原理**：与 `@Component` 相同，主要用于业务逻辑层
   - **使用**：
     ```java
     @Service
     public class OrderService {
         // ...
     }
     ```

4. **@Controller**
   - **作用**：标识控制器组件，是 `@Component` 的特化
   - **原理**：与 `@Component` 相同，主要用于 MVC 控制器
   - **使用**：
     ```java
     @Controller
     public class UserController {
         // ...
     }
     ```

5. **@Configuration**
   - **作用**：标识一个类为配置类，替代 XML 配置
   - **原理**：Spring 会特殊处理配置类，解析其中的 `@Bean` 方法
   - **使用**：
     ```java
     @Configuration
     public class AppConfig {
         @Bean
         public DataSource dataSource() {
             return new DriverManagerDataSource();
         }
     }
     ```

6. **@Bean**
   - **作用**：声明一个方法的返回值是一个 Bean
   - **原理**：Spring 会调用该方法并将返回值注册为 Bean
   - **使用**：
     ```java
     @Bean
     public RestTemplate restTemplate() {
         return new RestTemplate();
     }
     ```

7. **@ComponentScan**
   - **作用**：指定要扫描的包路径，自动发现和注册组件
   - **原理**：Spring 会扫描指定包及其子包下的所有 `@Component` 及其派生注解的类
   - **使用**：
     ```java
     @Configuration
     @ComponentScan("com.example")
     public class AppConfig {
     }
     ```

### 2. 依赖注入注解

1. **@Autowired**
   - **作用**：自动装配依赖
   - **原理**：Spring 会按类型查找匹配的 Bean 并注入
   - **使用**：
     ```java
     @Service
     public class UserService {
         @Autowired
         private UserRepository userRepository;
     }
     ```

2. **@Qualifier**
   - **作用**：与 `@Autowired` 配合使用，按名称指定要注入的 Bean
   - **原理**：当有多个同类型 Bean 时，通过名称精确指定
   - **使用**：
     ```java
     @Autowired
     @Qualifier("primaryDataSource")
     private DataSource dataSource;
     ```

3. **@Resource**
   - **作用**：JSR-250 标准注解，功能类似于 `@Autowired`
   - **原理**：默认按名称装配，可以通过 name 属性指定
   - **使用**：
     ```java
     @Resource(name = "myDataSource")
     private DataSource dataSource;
     ```

4. **@Value**
   - **作用**：注入简单值或表达式结果
   - **原理**：解析 SpEL 表达式或属性占位符
   - **使用**：
     ```java
     @Value("${jdbc.url}")
     private String jdbcUrl;
     
     @Value("#{systemProperties['user.name']}")
     private String userName;
     ```

### 3. 作用域和生命周期注解

1. **@Scope**
   - **作用**：定义 Bean 的作用域
   - **原理**：控制 Bean 的创建方式和生命周期
   - **使用**：
     ```java
     @Component
     @Scope("prototype")
     public class PrototypeBean {
         // ...
     }
     ```

2. **@PostConstruct**
   - **作用**：标识初始化方法
   - **原理**：Bean 初始化完成后调用
   - **使用**：
     ```java
     @PostConstruct
     public void init() {
         // 初始化逻辑
     }
     ```

3. **@PreDestroy**
   - **作用**：标识销毁方法
   - **原理**：Bean 销毁前调用
   - **使用**：
     ```java
     @PreDestroy
     public void cleanup() {
         // 清理逻辑
     }
     ```

### 4. 条件化注册注解

1. **@Conditional**
   - **作用**：条件化注册 Bean
   - **原理**：实现 Condition 接口定义条件逻辑
   - **使用**：
     ```java
     @Bean
     @Conditional(MyCondition.class)
     public MyBean myBean() {
         return new MyBean();
     }
     ```

2. **@Profile**
   - **作用**：根据环境 Profile 注册 Bean
   - **原理**：只在指定 Profile 激活时注册
   - **使用**：
     ```java
     @Configuration
     @Profile("dev")
     public class DevConfig {
         // ...
     }
     ```

### 5. 高级特性注解

1. **@Lazy**
   - **作用**：延迟初始化 Bean
   - **原理**：首次请求时才创建实例
   - **使用**：
     ```java
     @Component
     @Lazy
     public class LazyBean {
         // ...
     }
     ```

2. **@Primary**
   - **作用**：指定首选的 Bean
   - **原理**：当有多个同类型 Bean 时优先选择
   - **使用**：
     ```java
     @Bean
     @Primary
     public DataSource primaryDataSource() {
         return new DriverManagerDataSource();
     }
     ```

3. **@DependsOn**
   - **作用**：指定 Bean 的依赖顺序
   - **原理**：确保依赖的 Bean 先初始化
   - **使用**：
     ```java
     @Component
     @DependsOn("dataSourceInitializer")
     public class DatabaseService {
         // ...
     }
     ```

4. **@Import**
   - **作用**：导入其他配置类
   - **原理**：合并多个配置类的定义
   - **使用**：
     ```java
     @Configuration
     @Import({DatabaseConfig.class, SecurityConfig.class})
     public class AppConfig {
         // ...
     }
     ```

5. **@ImportResource**
   - **作用**：导入 XML 配置文件
   - **原理**：将 XML 配置与注解配置合并
   - **使用**：
     ```java
     @Configuration
     @ImportResource("classpath:applicationContext.xml")
     public class AppConfig {
         // ...
     }
     ```

## 原理总结

Spring IOC 容器的核心是通过注解驱动的方式管理 Bean 的生命周期：

1. **组件扫描**：`@ComponentScan` 触发类路径扫描，发现带有 `@Component` 及其派生注解的类
2. **Bean 定义**：扫描到的类被解析为 Bean 定义注册到容器
3. **依赖注入**：`@Autowired` 等注解触发依赖解析和注入
4. **生命周期管理**：`@PostConstruct` 和 `@PreDestroy` 等方法在适当时候被调用
5. **条件化处理**：`@Conditional` 和 `@Profile` 等注解根据条件决定是否注册 Bean
