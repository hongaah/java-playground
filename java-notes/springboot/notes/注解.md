# Spring Boot 注解汇总（原理 + 使用）

## 一、核心注解

### 1. `@SpringBootApplication`
- **原理**：组合了`@Configuration`+`@EnableAutoConfiguration`+`@ComponentScan`
- **使用**：主启动类注解
```java
@SpringBootApplication
public class MyApp {
    public static void main(String[] args) {
        SpringApplication.run(MyApp.class, args);
    }
}
```

### 2. `@EnableAutoConfiguration`
- **原理**：启用自动配置，加载META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports文件
- **使用**：通常不用单独使用，已包含在@SpringBootApplication中

## 二、Web相关注解

### 1. `@RestController`
- **原理**：组合了`@Controller`+`@ResponseBody`
- **使用**：声明RESTful控制器
```java
@RestController
@RequestMapping("/api")
public class MyController {
    @GetMapping("/hello")
    public String hello() {
        return "Hello World";
    }
}
```

### 2. `@RequestMapping`
- **原理**：映射HTTP请求到处理方法
- **使用**：定义请求路径和方式
```java
@RequestMapping(value = "/test", method = RequestMethod.GET)
```

### 3. 快捷映射注解
| 注解 | 等效写法 |
|------|---------|
| `@GetMapping` | `@RequestMapping(method=GET)` |
| `@PostMapping` | `@RequestMapping(method=POST)` |
| `@PutMapping` | `@RequestMapping(method=PUT)` |
| `@DeleteMapping` | `@RequestMapping(method=DELETE)` |
| `@PatchMapping` | `@RequestMapping(method=PATCH)` |

### 4. 参数处理注解
| 注解 | 原理 | 使用示例 |
|------|------|---------|
| `@PathVariable` | 从URI模板变量取值 | `/users/{id}` + `@PathVariable Long id` |
| `@RequestParam` | 从查询参数取值 | `?name=xx` + `@RequestParam String name` |
| `@RequestBody` | 反序列化请求体 | `@RequestBody User user` |
| `@RequestHeader` | 获取请求头 | `@RequestHeader("Accept") String accept` |
| `@CookieValue` | 获取Cookie | `@CookieValue("JSESSIONID") String cookie` |

## 三、依赖注入相关

### 1. `@Autowired`
- **原理**：按类型自动装配
- **使用**：自动注入Bean
```java
@Autowired
private UserService userService;
```

### 2. `@Qualifier`
- **原理**：按名称装配，解决多个同类型Bean问题
- **使用**：
```java
@Autowired
@Qualifier("userServiceImpl")
private UserService userService;
```

### 3. `@Resource`
- **原理**：JSR-250标准，默认按名称装配
- **使用**：
```java
@Resource(name = "userService")
private UserService userService;
```

### 4. `@Value`
- **原理**：注入属性值
- **使用**：
```java
@Value("${app.name}")
private String appName;
```

## 四、配置相关注解

### 1. `@Configuration`
- **原理**：声明配置类，替代XML配置
- **使用**：
```java
@Configuration
public class AppConfig {
    @Bean
    public DataSource dataSource() {
        return new HikariDataSource();
    }
}
```

### 2. `@Bean`
- **原理**：声明方法返回对象作为Bean
- **使用**：见上例

### 3. `@ConfigurationProperties`
- **原理**：绑定属性到对象
- **使用**：
```java
@ConfigurationProperties(prefix = "app")
public class AppProperties {
    private String name;
    private String version;
    // getters/setters
}
```

### 4. `@PropertySource`
- **原理**：加载指定配置文件
- **使用**：
```java
@Configuration
@PropertySource("classpath:custom.properties")
public class AppConfig {}
```

## 五、AOP相关注解

### 1. `@Aspect`
- **原理**：声明切面类
- **使用**：
```java
@Aspect
@Component
public class LogAspect {
    @Before("execution(* com.example..*.*(..))")
    public void logBefore(JoinPoint jp) {
        // 前置通知逻辑
    }
}
```

### 2. 通知类型注解
| 注解 | 执行时机 |
|------|---------|
| `@Before` | 方法执行前 |
| `@After` | 方法执行后 |
| `@AfterReturning` | 方法正常返回后 |
| `@AfterThrowing` | 方法抛出异常后 |
| `@Around` | 方法执行前后 |

## 六、数据相关注解

### 1. JPA注解
| 注解 | 作用 |
|------|-----|
| `@Entity` | 声明JPA实体 |
| `@Table` | 指定映射表 |
| `@Id` | 声明主键 |
| `@GeneratedValue` | 主键生成策略 |
| `@Column` | 映射表字段 |
| `@OneToMany` | 一对多关系 |
| `@ManyToOne` | 多对一关系 |

### 2. 事务注解
| 注解 | 说明 |
|------|-----|
| `@Transactional` | 声明事务 |
| `@EnableTransactionManagement` | 启用事务管理 |

## 七、测试相关注解

### 1. `@SpringBootTest`
- **原理**：加载完整Spring应用上下文
- **使用**：
```java
@SpringBootTest
class MyTest {
    @Autowired
    private UserService userService;
}
```

### 2. `@WebMvcTest`
- **原理**：仅加载Web层相关Bean
- **使用**：
```java
@WebMvcTest(UserController.class)
class UserControllerTest {
    @Autowired
    private MockMvc mockMvc;
}
```

### 3. `@DataJpaTest`
- **原理**：仅加载JPA相关配置
- **使用**：
```java
@DataJpaTest
class UserRepositoryTest {
    @Autowired
    private UserRepository userRepository;
}
```

## 八、其他重要注解

### 1. `@Conditional`系列
| 注解 | 条件 |
|------|-----|
| `@ConditionalOnClass` | 类路径存在指定类时生效 |
| `@ConditionalOnMissingBean` | 容器不存在指定Bean时生效 |
| `@ConditionalOnProperty` | 配置属性满足条件时生效 |

### 2. `@Scheduled`
- **原理**：定时任务执行
- **使用**：
```java
@Scheduled(cron = "0 * * * * ?")
public void task() {
    // 每小时执行
}
```

### 3. `@Async`
- **原理**：异步方法调用
- **使用**：
```java
@Async
public void asyncTask() {
    // 异步执行
}
```

### 4. `@Cacheable`
- **原理**：方法结果缓存
- **使用**：
```java
@Cacheable("users")
public User getUser(Long id) {
    return userRepository.findById(id);
}
```

## 总结

| 类别 | 核心注解 |
|------|---------|
| 启动配置 | `@SpringBootApplication`, `@EnableAutoConfiguration` |
| Web开发 | `@RestController`, `@RequestMapping`, `@GetMapping`等 |
| 依赖注入 | `@Autowired`, `@Qualifier`, `@Resource` |
| 配置管理 | `@Configuration`, `@Bean`, `@ConfigurationProperties` |
| AOP编程 | `@Aspect`, `@Before`, `@After`等 |
| 数据访问 | JPA注解, `@Transactional` |
| 测试 | `@SpringBootTest`, `@WebMvcTest` |
| 高级特性 | `@Conditional`, `@Scheduled`, `@Async` |
